<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0060)http://finance.ifeng.com/app/money/calc/Html/CalcLoanChg.htm -->
<HTML><HEAD><TITLE>金融计算器</TITLE>
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<SCRIPT>
 //window.resizeTo(540,554);  
		</SCRIPT>

<SCRIPT language=javascript src="CalcFiles/WinControl.js"></SCRIPT>

<SCRIPT language=javascript>CaculResize(542,568);</SCRIPT>

<SCRIPT language=javascript src="CalcFiles/Calendar.js"></SCRIPT>

<SCRIPT language=javascript src="CalcFiles/Calculator.js"></SCRIPT>

<SCRIPT language=javascript src="CalcFiles/WBselect.js"></SCRIPT>

<SCRIPT language=javascript src="CalcFiles/GetRate.js"></SCRIPT>

<SCRIPT language=javascript src="CalcFiles/Components.js"></SCRIPT>

<SCRIPT language=javascript src="../My97DatePicker/WdatePicker.js"></SCRIPT>

<SCRIPT language=javascript 
src="CalcFiles/CheckDataFunction.js"></SCRIPT>

<SCRIPT language=javascript src="CalcFiles/CalcLoanChg.js"></SCRIPT>
<LINK rel=STYLESHEET type=text/css href="CalcFiles/Style.css">
<META name=GENERATOR content="MSHTML 9.00.8112.16561"></HEAD>
<BODY bottomMargin=0 leftMargin=0 rightMargin=0 topMargin=0 bgColor=#ffffff 
text=#000000 MS_POSITIONING="GridLayout">
<DIV id=bg1 style="width:540px;"><IMG src="CalcFiles/bg1.gif"><IMG 
src="CalcFiles/bg2.gif" width=255 height=126><IMG 
src="CalcFiles/bg3.gif"></DIV>
<DIV id=bg2 style="width:540px;"><IMG src="CalcFiles/bg4.gif" width=25 height=280><IMG 
src="CalcFiles/bg5.gif" width=480 height=280><IMG 
src="CalcFiles/bg6.gif" width=25 height=280></DIV>
<DIV id=bg3 style="width:540px;"><IMG src="CalcFiles/bg7.gif"><IMG 
src="CalcFiles/bg8.gif" width=480 height=119><IMG 
src="CalcFiles/bg9.gif"></DIV>
<DIV id=FDiv1 class=FDiv1 Movable="1">利率变动后还款计算器</DIV>
<DIV style="WIDTH: 480px" id=FDiv2 class=FDiv2 
Movable="1">本计算器是计算当长期贷款（等额本息还款）的利率发生一次或多次变动后，在其它条件不变的情况下，每期还款额和最终总偿付利息额的变动情况。</DIV>
<FORM id=CalcLoanChg onsubmit="return false;" name=CalcLoanChg>
<DIV style="WIDTH: 500px" id=FDiv3 class=FDiv3 align=center>
<TABLE id=Table2 border=0 width="90%">
  <TBODY>
  <TR>
    <TD style="DISPLAY: none">贷款类型</TD>
    <TD style="DISPLAY: none"><SELECT id=edType onchange=TypeChange() 
      name=edType> <OPTION selected value=0>商业贷款</OPTION> <OPTION 
        value=1>公积金贷款</OPTION></SELECT></TD></SELECT>
    <TD></TD></TR>
  <TR>
    <TD>贷款总额(元)</TD>
    <TD><INPUT style="WIDTH: 100px" id=edLoanSum class=txtnum tabIndex=1 
      name=edLoanSum value=0></TD>
    <TD><INPUT id=btnCalc class=btn tabIndex=11 onclick="javascript:if(CheckData()) Execute(document);" name=btnCalc value=" 计算 " type=button></TD></TR>
  <TR>
    <TD>贷款期限(年)</TD>
    <TD><INPUT onblur=TypeChange() style="WIDTH: 100px" id=edLoanYears 
      class=txtnum tabIndex=2 name=edLoanYears value=10></TD>
    <TD></TD></TR>
  <TR>
    <TD>初始还款时间</TD>
    <TD><INPUT onblur=ChkCZDate(document.all.edDate1); onClick="WdatePicker()" style="WIDTH: 100px" 
      id=edDate1 class=txt tabIndex=3 name=edDate1 value=2003-1-3> <IMG 
      style="CURSOR: hand" onclick="WdatePicker({el:'edDate1'})"
      align=absMiddle src="CalcFiles/Calendar1.gif"> </TD>
    <TD></TD></TR>
  <TR>
    <TD>原贷款年利率(%)</TD>
    <TD><INPUT style="WIDTH: 100px" id=edRate1 class=txtnum tabIndex=4 
      name=edRate1 value=4.77></TD>
    <TD></TD></TR>
  <TR>
    <TD colSpan=4>利率变动情况</TD></TR>
  <TR>
    <TD>新利率执行日期</TD>
    <TD><INPUT onblur=ChkCZDate(document.all.edDate2); onClick="WdatePicker()" style="WIDTH: 100px" 
      id=edDate2 class=txt tabIndex=5 name=edDate2 value=2003-1-3> <IMG 
      style="CURSOR: hand" onclick="WdatePicker({el:'edDate2'})" 
      align=absMiddle src="CalcFiles/Calendar1.gif"> </TD>
    <TD width=67>利率(%)</TD>
    <TD><INPUT style="WIDTH: 100px" id=edRate2 class=txtnum tabIndex=6 
      name=edRate2></TD></TR>
  <TR>
    <TD>新利率执行日期</TD>
    <TD><INPUT onblur=ChkCZDate(document.all.edDate3); onClick="WdatePicker()" style="WIDTH: 100px" 
      id=edDate3 class=txt tabIndex=7 name=edDate3 value=2003-1-3> <IMG 
      style="CURSOR: hand" onclick="WdatePicker({el:'edDate3'})" 
      align=absMiddle src="CalcFiles/Calendar1.gif"> </TD>
    <TD width=67>利率(%)</TD>
    <TD><INPUT style="WIDTH: 100px" id=edRate3 class=txtnum tabIndex=8 
      name=edRate3></TD></TR>
  <TR>
    <TD>新利率执行日期</TD>
    <TD><INPUT onblur=ChkCZDate(document.all.edDate4); onClick="WdatePicker()" style="WIDTH: 100px" 
      id=edDate4 class=txt tabIndex=9 name=edDate4 value=2003-1-3> <IMG 
      style="CURSOR: hand" onclick="WdatePicker({el:'edDate4'})" 
      align=absMiddle src="CalcFiles/Calendar1.gif"> </TD>
    <TD width=67>利率(%)</TD>
    <TD><INPUT style="WIDTH: 100px" id=edRate4 class=txtnum tabIndex=10 
      name=edRate4></TD></TR>
  <TR>
    <TD height=5 colSpan=4>
      <HR SIZE=1 width=400>
    </TD></TR>
  <TR>
    <TD colSpan=4 align=center>
      <DIV id=divReturnList>
                                <xml id=xmlresult async="false">
									<Root>
										<Items>
											<Memo />
											<MonthRet />
											<Interest />
										</Items>
									</Root>
								</xml>
      <TABLE id=Table3 dataSrc=#xmlresult border=0 width=430 >
        <THEAD>
        <TR class=head>
          <TH align=center>说明</TH>
          <TH align=center>月还款额(元)</TH>
          <TH align=center>利息总额(元)</TH></TR></THEAD>
        <TBODY>
        <TR>
          <TD align=left><SPAN dataFld=Memo></SPAN></TD>
          <TD align=right><SPAN dataFld=MonthRet></SPAN></TD>
          <TD align=right><SPAN 
      dataFld=Interest></SPAN></TD></TR>

        <table id="xmlchg">                      
        </table>							
							
      
      </TBODY></TABLE></DIV>

                            <xml id=xmldso async="false">
								<Root>
									<Items>
										<Times />
										<Year />
										<RateSum />
										<Corpus />
										<CorpusRate />
										<LeavCorpus />
									</Items>
								</Root>
							</xml>
                            </TD></TR></TBODY></TABLE></DIV></FORM>
                            <xml id=xmlLoanRate src="../Data/LoanAndOtherLoan.xml"></xml>
<SCRIPT language=javascript>
		function ChkCZDate(edit)
		{
			edit.value=Trim(edit.value);
			if(edit.value=="")
				return true;
			if(!Cal_datevalid(edit,'1910-1-1','3000-1-1')) 
			{
				alert('日期格式不正确,日期有效范围为1910年到3000年');
				edit.focus();
			}
		}

		function CheckData()
		{
			if (!CheckPN(this.document.all.edLoanSum,"请在贷款总额输入正整数",false))
				return false;
			if (!CheckPN(this.document.all.edLoanYears,"请在贷款期限输入正整数",false))
				return false;
			if (!CheckFN3(this.document.all.edRate1,"请在原贷款年利率输入正数",false,null,4))
				return false;
			if (!CheckEmpty(this.document.all.edDate1,"无效的初始还款时间"))
				return false;
			if(Trim(document.all.edRate2.value)!="")
			{
			if (!CheckFN3(this.document.all.edRate2,"请在利率输入正数",false,null,4))
				return false;
			else
				Rate2=parseFloat(document.all.edRate2.value)/100;		
			}
			else
				Rate2=-1;    // Rate2=0;  // modified by huhao, 2003/4/30: 用-1表示无值
			if(Trim(document.all.edRate3.value)!="")
			{
				if (!CheckFN3(this.document.all.edRate3,"请在利率输入正数",false,null,4))
					return false;
				else
					Rate3=parseFloat(document.all.edRate3.value)/100;		
			}
			else
				Rate3=-1;    // Rate3=0; // modified by huhao, 2003/4/30: 用-1表示无值
			if(Trim(document.all.edRate4.value)!="")
			{
			if (!CheckFN3(this.document.all.edRate4,"请在利率输入正数",false,null,4))
				return false;
			else
				Rate4=parseFloat(document.all.edRate4.value)/100;
			}
			else
			Rate4=-1;    // Rate4=0; // modified by huhao, 2003/4/30: 用-1表示无值
			if ((Rate2 < 0 )&&( Rate3 >= 0))
			{
				DispMessage(document.all.edRate2, "请在利率输入正数");
				return false;
			}
			if ((Rate3 < 0) &&( Rate4 >= 0))
			{
				DispMessage(document.all.edRate3, "请在利率输入正数");
				return false;
			}
			if(document.all.edRate2.value!='' && new Number(document.all.edRate2.value) > 0)
			{
				if (!CheckEmpty(this.document.all.edDate2,"无效的利率变动日期"))
					return false;
			}
			if(document.all.edRate3.value!='' && new Number(document.all.edRate3.value) > 0)
			{
				if (!CheckEmpty(this.document.all.edDate3,"无效的利率变动日期"))
					return false;
			}
			if(document.all.edRate4.value!='' && new Number(document.all.edRate4.value) > 0)
			{
				if (!CheckEmpty(this.document.all.edDate4,"无效的利率变动日期"))
					return false;
			}
			
			var Rate1 = parseFloat(document.all.edRate1.value) / 100;
			var dtLater, dtEarlier;
			if (Rate2 > 0)
			{
				dtEarlier = Cal_strtodate(document.all.edDate1.value);
				dtLater = Cal_strtodate(document.all.edDate2.value);
				if (dtLater <= dtEarlier)
				{
					DispMessage(document.all.edDate2, "新利率执行日期必须晚于初始还款时间");
					return false;
				}
				else
				{
					var limitDate = new Date(dtEarlier);
					var tempLoanYears = parseInt(document.all.edLoanYears.value);
					//alert(tempLoanYears);
					limitDate = new Date(limitDate.getFullYear() + tempLoanYears,limitDate.getMonth(),limitDate.getDate());
					if(dtLater > limitDate)
					{
						//alert("日期过了！"+"\nlimitDate="+limitDate.toLocaleString()+"\ndtLater="+dtLater);
						DispMessage(document.all.edDate2, "新利率执行日期必须小于初始还款时间+贷款期限");
						return false;
					}
				}
			}
			if (Rate3 > 0)
			{
				dtEarlier = Cal_strtodate(document.all.edDate2.value);
				dtLater = Cal_strtodate(document.all.edDate3.value);
				if (dtLater <= dtEarlier)
				{
					DispMessage(document.all.edDate3, "第二次利率变动日期必须晚于第一次利率变动日期");
					return false;
				}	
				else
				{
					var limitDate = new Date(Cal_strtodate(document.all.edDate1.value));
					var tempLoanYears = parseInt(document.all.edLoanYears.value);
					limitDate = new Date(limitDate.getFullYear() + tempLoanYears,limitDate.getMonth(),limitDate.getDate());
					if(dtLater > limitDate)
					{
						DispMessage(document.all.edDate3, "第二次利率执行日期必须小于初始还款时间+贷款期限");
						return false;
					}
				}	
			}
			if (Rate4 > 0)
			{
				dtEarlier = Cal_strtodate(document.all.edDate3.value);
				dtLater = Cal_strtodate(document.all.edDate4.value);
				if (dtLater <= dtEarlier)
				{
					DispMessage(document.all.edDate4, "第三次利率变动日期必须晚于第二次利率变动日期");
					return false;
				}		
				else
				{
					var limitDate = new Date(Cal_strtodate(document.all.edDate1.value));
					var tempLoanYears = parseInt(document.all.edLoanYears.value);
					limitDate = new Date(limitDate.getFullYear() + tempLoanYears,limitDate.getMonth(),limitDate.getDate());
					if(dtLater > limitDate)
					{
						DispMessage(document.all.edDate4, "第三次利率执行日期必须小于初始还款时间+贷款期限");
						return false;
					}
				}	
			}
			return true;
		}

		function SetTableColor(table)
		{
			for(i=0;i<=table.length-1;i++)
			{
				if(i==0)
					table.rows(i).className="head";
				else
				{
					if (i%2)
						table.rows(i).className="odd";
					else
						table.rows(i).className="even";
				}
			}
		}		

		function TypeChange()
		{
			var IDType = "1";
			if (this.document.all.edType.selectedIndex == 1) IDType = "2";
			var period = (this.document.all.edLoanYears.value) * 12;
			var ret = GetLoanRatio(IDType,period,xmlLoanRate);
			if(ret == undefined)
			{
				document.all.edLoanYears.select();
				document.all.edLoanYears.focus();
			}
			else
			{
				this.document.all.edRate1.value = ret;//GetLoanRatio(IDType, period, xmlLoanRate);
			}
		}

		function init()
		{
			TypeChange();
		}

		this.document.all.edDate1.value=datetostring(new Date());
		this.document.all.edDate2.value=datetostring(new Date());
		this.document.all.edDate3.value=datetostring(new Date());
		this.document.all.edDate4.value=datetostring(new Date());
		window.attachEvent("onload",init);				
	//	GetCalc_Close();
		</SCRIPT>

<SCRIPT language=javascript src="CalcFiles/sta_collection.js"></SCRIPT>
</BODY></HTML>
